#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var yargs = require("yargs");
var index_1 = require("./index");
var chalk = require("chalk");
var argv = yargs
    .usage('Usage: $0 -u [device udid] -i [app bundle id]')
    .option("udid", { string: true, array: true, describe: "Provide one or more device UUIDs the searched provisioning profile should be able to deploy to." })
    .alias('u', 'udid')
    .option("app-id", { string: true, array: false, describe: "Provide application bundle identifier the searched provisioning profile should match." })
    .alias('i', 'app-id')
    .option('eligable', { boolean: true, array: false, describe: "Prints only eligable profiles", default: false })
    .alias('e', 'eligable')
    .option('team', { string: true, array: false, describe: "Provide team name the provisioning profile should belong to." })
    .alias('t', 'team')
    .option('type', { string: true, array: false, choices: ["development", "distribution", "adhoc", "all"], default: "development", describe: "'development', 'distribution', 'adhoc' or 'all'; - specify the provisioning profile type." })
    .alias('p', 'type')
    .help('h')
    .alias('h', 'help')
    .argv;
// console.log(argv);
var options = {};
if (argv.udid) {
    options.ProvisionedDevices = argv.uuid;
}
if (argv["app-id"]) {
    options.AppId = argv["app-id"];
}
if (argv["type"] != 'all') {
    options.Type = {
        "development": "Development",
        "distribution": "Distribution",
        "adhoc": "AdHoc",
        "enterprise": "Enterprise"
    }[argv["type"]];
}
if (argv["team"]) {
    options.TeamName = argv["team"];
}
var certs = index_1.cert.read();
options.Certificates = certs.valid;
var profiles = index_1.provision.read();
var result = index_1.provision.select(profiles, options);
var months = ["Jan", "Feb", "Marc", "Apr", "May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec"];
function formatDate(date) {
    return date.getDate() + " " + months[date.getMonth()] + " " + date.getFullYear();
}
function formatProfile(profile) {
    return "'" + chalk.bold(profile.Name) + "' " + profile.TeamName + " " + chalk.gray("(exp: " + formatDate(profile.ExpirationDate) + ") " + profile.UUID + " id: ") + profile.Entitlements["application-identifier"] + chalk.gray(" " + profile.Type);
}
console.log(chalk.bold("eligable:"));
result.eligable.forEach(function (p) { return console.log(" - " + formatProfile(p)); });
if (!argv.eligable) {
    console.log(chalk.bold("non eligable:"));
    result.nonEligable.forEach(function (p) { return console.log(" - " + formatProfile(p)); });
}
//# sourceMappingURL=ios-mobileprovision-finder.js.map